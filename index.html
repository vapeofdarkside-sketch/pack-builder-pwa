<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Pack Builder</title>

<link rel="manifest" href="manifest.webmanifest" />

<style>
body {
  background:#0e1117;
  color:#fff;
  font-family:Arial, sans-serif;
  margin:0;
  padding:20px;
}

h1 {
  margin-top:0;
}

.card {
  background:#161b22;
  padding:15px;
  border-radius:12px;
  margin-bottom:15px;
}

input, select {
  width:100%;
  padding:8px;
  margin-top:5px;
  margin-bottom:10px;
  border-radius:8px;
  border:none;
  font-size:16px;
}

table {
  width:100%;
  border-collapse:collapse;
}

td {
  padding:6px 0;
}

td:last-child {
  text-align:right;
}

.green { color:#4caf50; }
.yellow { color:#ffc107; }
.red { color:#f44336; }
</style>
</head>
<body>

<h1>Battery Pack Calculator</h1>

<div class="card">
  <h3>Zelltyp</h3>

  <label>Format</label>
  <select id="format">
    <option value="18650">18650</option>
    <option value="20700">20700</option>
    <option value="21700">21700</option>
  </select>

  <label>Kapazität (mAh)</label>
  <input type="number" id="capacity" value="3500">

  <label>Max. Dauerstrom (A)</label>
  <input type="number" id="maxA" value="10">

  <label>Nominalspannung (V)</label>
  <input type="number" step="0.01" id="nomV" value="3.60">

  <label>Vollspannung (V)</label>
  <input type="number" step="0.01" id="fullV" value="4.20">
</div>

<div class="card">
  <h3>Pack Konfiguration</h3>

  <label>Serien (S)</label>
  <input type="number" id="series" value="3">

  <label>Parallel (P)</label>
  <input type="number" id="parallel" value="2">
</div>

<div class="card">
  <h3>Zellen Info</h3>
  <table id="cellInfo"></table>
</div>

<div class="card">
  <h3>Pack Info</h3>
  <table id="packInfo"></table>
</div>

<script>
function update() {

  const format = document.getElementById("format").value;
  const capacity = parseFloat(document.getElementById("capacity").value);
  const maxA = parseFloat(document.getElementById("maxA").value);
  const nomV = parseFloat(document.getElementById("nomV").value);
  const fullV = parseFloat(document.getElementById("fullV").value);
  const S = parseInt(document.getElementById("series").value);
  const P = parseInt(document.getElementById("parallel").value);

  const storageV = 3.80;
  const cutoffRec = 3.30;
  const cutoffAbs = 3.00;

  const totalCells = S * P;

  const packNomV = nomV * S;
  const packFullV = fullV * S;
  const packStorageV = storageV * S;
  const packCutRec = cutoffRec * S;
  const packCutAbs = cutoffAbs * S;

  const packAh = (capacity / 1000) * P;
  const packWh = packNomV * packAh;
  const packMaxA = maxA * P;

  document.getElementById("cellInfo").innerHTML = `
    <tr><td>Format</td><td>${format}</td></tr>
    <tr><td>Nominal</td><td>${nomV.toFixed(2)} V</td></tr>
    <tr><td>Voll</td><td>${fullV.toFixed(2)} V</td></tr>
    <tr><td>Kapazität</td><td>${capacity} mAh</td></tr>
    <tr><td>Max Strom</td><td>${maxA} A</td></tr>
  `;

  document.getElementById("packInfo").innerHTML = `
    <tr><td>Konfiguration</td><td>${S}S${P}P</td></tr>
    <tr><td>Zellen gesamt</td><td>${totalCells}</td></tr>
    <tr><td>Nominalspannung</td><td>${packNomV.toFixed(2)} V</td></tr>
    <tr><td>Vollspannung</td><td>${packFullV.toFixed(2)} V</td></tr>
    <tr><td class="green">Lagerspannung</td><td class="green">${packStorageV.toFixed(2)} V</td></tr>
    <tr><td class="yellow">Entladen bis (empf.)</td><td class="yellow">${packCutRec.toFixed(2)} V</td></tr>
    <tr><td class="red">Absolute Untergrenze</td><td class="red">${packCutAbs.toFixed(2)} V</td></tr>
    <tr><td>Kapazität</td><td>${packAh.toFixed(2)} Ah</td></tr>
    <tr><td>Energie</td><td>${packWh.toFixed(1)} Wh</td></tr>
    <tr><td>Max Dauerstrom</td><td>${packMaxA.toFixed(1)} A</td></tr>
  `;
}

document.querySelectorAll("input, select").forEach(el => {
  el.addEventListener("input", update);
});

update();
</script>

</body>
</html>
